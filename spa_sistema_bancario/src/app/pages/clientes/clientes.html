<div *ngIf="error()" class="alert alert--error">
  <span class="alert__icon"><i class="material-icons">warning</i></span>
  <span class="alert__message">{{ error() }}</span>
  <button class="alert__close" (click)="clearMessages()"><i class="material-icons">close</i></button>
</div>
<div *ngIf="successMessage()" class="alert alert--success">
  <span class="alert__icon"><i class="material-icons">check_circle</i></span>
  <span class="alert__message">{{ successMessage() }}</span>
  <button class="alert__close" (click)="clearMessages()"><i class="material-icons">close</i></button>
</div>
<section class="card">
  <div class="card__header">
    <div class="card__actions">
      <div class="search-controls">
        <input
          type="text"
          [ngModel]="searchTerm()"
          (ngModelChange)="onSearchChange($event)"
          class="search__input"
          placeholder="Buscar por identificación, nombre o teléfono..."
          [disabled]="isLoading()"
        />
        <button 
          *ngIf="searchTerm()" 
          class="search__clear"
          (click)="clearSearch()"
          title="Limpiar búsqueda"
        >
          <i class="material-icons">close</i>
        </button>
      </div>
      <button 
        class="btn btn--primary"
        (click)="openCreateModal()"
        [disabled]="isLoading()"
      >
        <i class="material-icons">person_add</i>
        Agregar Cliente
      </button>
    </div>
  </div>
  <div *ngIf="isLoading()" class="loading">
    <div class="loading__spinner"></div>
    <span>Cargando clientes...</span>
  </div>
  <div *ngIf="!isLoading()" class="table-container enhanced-table">
    <table class="data-table" *ngIf="filteredClients().length > 0">
      <thead class="data-table__header">
        <tr>
          <th>Identificación</th>
          <th>Nombre Completo</th>
          <th>Género</th>
          <th>Edad</th>
          <th>Teléfono</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody class="data-table__body">
        <tr *ngFor="let client of filteredClients(); trackBy: trackByClientId">
          <td class="font-semibold">{{ client.identificacion }}</td>
          <td>{{ client.nombre }}</td>
          <td>{{ client.genero || 'No especificado' }}</td>
          <td>{{ client.edad || 'No especificado' }}</td>
          <td>{{ client.telefono }}</td>
          <td>
            <div class="table-actions">
              <button 
                class="action-btn action-btn--edit" 
                title="Editar cliente"
                (click)="openEditModal(client)"
                [disabled]="isLoading()"
              >
                <i class="material-icons">edit</i>
              </button>
              <button 
                class="action-btn action-btn--delete" 
                title="Eliminar cliente"
                (click)="openDeleteModal(client)"
                [disabled]="isLoading()"
              >
                <i class="material-icons">delete</i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="empty-state" *ngIf="filteredClients().length === 0 && !isLoading()">
      <div class="empty-state__icon"><i class="material-icons">group</i></div>
      <div class="empty-state__title">
        {{ searchTerm() ? 'No se encontraron clientes' : 'No hay clientes registrados' }}
      </div>
      <div class="empty-state__description">
        {{ searchTerm() ? 'Intenta con otros términos de búsqueda' : 'Comienza agregando tu primer cliente' }}
      </div>
    </div>
  </div>
</section>
<app-modal
  [isOpen]="isCreateModalOpen()"
  [config]="createModalConfig"
  (close)="closeCreateModal()"
>
  <app-client-form
    #createClientForm
    [client]="null"
    [isEditMode]="false"
    (formSubmit)="onCreateClient($event)"
    (formCancel)="closeCreateModal()"
  ></app-client-form>
</app-modal>
<app-modal
  [isOpen]="isEditModalOpen()"
  [config]="editModalConfig"
  (close)="closeEditModal()"
>
  <app-client-form
    #editClientForm
    [client]="selectedClient()"
    [isEditMode]="true"
    (formSubmit)="onEditClient($event)"
    (formCancel)="closeEditModal()"
  ></app-client-form>
</app-modal>
<app-modal
  [isOpen]="isDeleteModalOpen()"
  [config]="deleteModalConfig"
  (close)="closeDeleteModal()"
>
  <div class="delete-confirmation">
    <div class="delete-confirmation__icon"><i class="material-icons">warning</i></div>
    <div class="delete-confirmation__content">
      <p class="delete-confirmation__text">
        ¿Eliminar cliente?
      </p>
    </div>
  </div>
  <div slot="footer" class="modal__footer-buttons">
    <button class="btn btn--outline" (click)="closeDeleteModal()">Cancelar</button>
    <button class="btn btn--primary delete-btn" (click)="confirmDelete()">Eliminar</button>
  </div>
</app-modal>
