<div *ngIf="error()" class="alert alert--error">
  <span class="alert__icon">âš ï¸</span>
  <span class="alert__message">{{ error() }}</span>
  <button class="alert__close" (click)="clearMessages()">âœ•</button>
</div>
<div *ngIf="successMessage()" class="alert alert--success">
  <span class="alert__icon">âœ…</span>
  <span class="alert__message">{{ successMessage() }}</span>
  <button class="alert__close" (click)="clearMessages()">âœ•</button>
</div>
<section class="card">
  <div class="card__header">
    <div class="card__actions">
      <div class="search-controls">
        <input
          type="text"
          [ngModel]="searchTerm()"
          (ngModelChange)="onSearchChange($event)"
          class="search__input"
          placeholder="Buscar por identificaciÃ³n, nombre o telÃ©fono..."
          [disabled]="isLoading()"
        />
        <button 
          *ngIf="searchTerm()" 
          class="search__clear"
          (click)="clearSearch()"
          title="Limpiar bÃºsqueda"
        >
          âœ•
        </button>
      </div>
      <button 
        class="btn btn--primary"
        (click)="openCreateModal()"
        [disabled]="isLoading()"
      >
        <span class="btn__icon">â•</span>
        Agregar Cliente
      </button>
    </div>
  </div>
  <div *ngIf="isLoading()" class="loading">
    <div class="loading__spinner"></div>
    <span>Cargando clientes...</span>
  </div>
  <div *ngIf="!isLoading()" class="table-container">
    <table class="data-table" *ngIf="filteredClients().length > 0">
      <thead class="data-table__header">
        <tr>
          <th>IdentificaciÃ³n</th>
          <th>Nombre Completo</th>
          <th>GÃ©nero</th>
          <th>Edad</th>
          <th>TelÃ©fono</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody class="data-table__body">
        <tr *ngFor="let client of filteredClients(); trackBy: trackByClientId">
          <td class="font-semibold">{{ client.identificacion }}</td>
          <td>{{ client.nombre }}</td>
          <td>{{ client.genero || 'No especificado' }}</td>
          <td>{{ client.edad || 'No especificado' }}</td>
          <td>{{ client.telefono }}</td>
          <td>
            <div class="table-actions">
              <button 
                class="action-btn action-btn--edit" 
                title="Editar cliente"
                (click)="openEditModal(client)"
                [disabled]="isLoading()"
              >
                âœï¸
              </button>
              <button 
                class="action-btn action-btn--delete" 
                title="Eliminar cliente"
                (click)="openDeleteModal(client)"
                [disabled]="isLoading()"
              >
                ğŸ—‘ï¸
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="empty-state" *ngIf="filteredClients().length === 0 && !isLoading()">
      <div class="empty-state__icon">ğŸ‘¥</div>
      <div class="empty-state__title">
        {{ searchTerm() ? 'No se encontraron clientes' : 'No hay clientes registrados' }}
      </div>
      <div class="empty-state__description">
        {{ searchTerm() ? 'Intenta con otros tÃ©rminos de bÃºsqueda' : 'Comienza agregando tu primer cliente' }}
      </div>
      <button 
        *ngIf="!searchTerm()" 
        class="btn btn--primary"
        (click)="openCreateModal()"
      >
        <span class="btn__icon">â•</span>
        Agregar Primer Cliente
      </button>
    </div>
  </div>
</section>
<app-modal
  [isOpen]="isCreateModalOpen()"
  [config]="createModalConfig"
  (close)="closeCreateModal()"
>
  <app-client-form
    #createClientForm
    [client]="null"
    [isEditMode]="false"
    (formSubmit)="onCreateClient($event)"
    (formCancel)="closeCreateModal()"
  ></app-client-form>
</app-modal>
<app-modal
  [isOpen]="isEditModalOpen()"
  [config]="editModalConfig"
  (close)="closeEditModal()"
>
  <app-client-form
    #editClientForm
    [client]="selectedClient()"
    [isEditMode]="true"
    (formSubmit)="onEditClient($event)"
    (formCancel)="closeEditModal()"
  ></app-client-form>
</app-modal>
<app-modal
  [isOpen]="isDeleteModalOpen()"
  [config]="deleteModalConfig"
  (close)="closeDeleteModal()"
>
  <div class="delete-confirmation">
    <div class="delete-confirmation__icon">âš ï¸</div>
    <div class="delete-confirmation__content">
      <p class="delete-confirmation__text">
        Â¿EstÃ¡ seguro que desea eliminar al cliente?
      </p>
      <div class="delete-confirmation__details" *ngIf="selectedClient()">
        <strong>{{ selectedClient()!.nombre }}</strong><br>
        <span class="text-muted">IdentificaciÃ³n: {{ selectedClient()!.identificacion }}</span>
      </div>
      <p class="delete-confirmation__warning">
        Esta acciÃ³n no se puede deshacer.
      </p>
    </div>
  </div>
  <div slot="footer" class="modal__footer-buttons">
    <button 
      class="btn btn--outline" 
      (click)="closeDeleteModal()"
    >
      Cancelar
    </button>
    <button 
      class="btn btn--primary delete-btn" 
      (click)="confirmDelete()"
    >
      Eliminar
    </button>
  </div>
</app-modal>
